<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - EventHub IQ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>

<body>
    <div class="auth-wrapper">
        <div class="auth-header" style="text-align: center; margin-bottom: 3rem;">
            <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">EventHub AI</h1>
            <p style="color: var(--text-secondary); font-size: 1.1rem;">Smart Resource Allocation System</p>
            <p style="color: var(--text-secondary); margin-top: 1rem;">Choose your role to continue</p>
        </div>

        <div id="error-box" class="error-msg" style="display: none; max-width: 900px; margin: 0 auto 2rem auto;"></div>

        <!-- 3 Role-Based Login Cards -->
        <div
            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; max-width: 1200px; margin: 0 auto;">

            <!-- ADMIN Card -->
            <div class="role-card"
                style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(220, 38, 38, 0.08)); border: 2px solid rgba(239, 68, 68, 0.4); border-radius: 20px; padding: 2.5rem;">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div
                        style="width: 80px; height: 80px; margin: 0 auto 1rem; background: rgba(239, 68, 68, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ph-fill ph-shield-check" style="font-size: 3rem; color: #ef4444;"></i>
                    </div>
                    <h2 style="margin: 0 0 0.5rem 0; color: #ef4444; font-size: 1.8rem;">Admin</h2>
                    <p style="font-size: 0.9rem; color: var(--text-secondary); margin: 0;">Full System Control</p>
                </div>

                <form class="auth-form" data-role="admin">
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Email</label>
                        <input type="email" class="chat-input" value="admin@gmail.com" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Password</label>
                        <input type="password" class="chat-input" value="admin@123" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <button type="submit" class="send-btn auth-btn"
                        style="width: 100%; background: #ef4444; color: white; border: none; padding: 1rem; border-radius: 10px; font-weight: 600; font-size: 1rem; cursor: pointer; margin-top: 1rem;">
                        <i class="ph ph-sign-in"></i> Sign In as Admin
                    </button>
                </form>
            </div>

            <!-- TEACHER Card -->
            <div class="role-card"
                style="background: linear-gradient(135deg, rgba(56, 189, 248, 0.15), rgba(14, 165, 233, 0.08)); border: 2px solid rgba(56, 189, 248, 0.4); border-radius: 20px; padding: 2.5rem;">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div
                        style="width: 80px; height: 80px; margin: 0 auto 1rem; background: rgba(56, 189, 248, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ph-fill ph-chalkboard-teacher" style="font-size: 3rem; color: #38bdf8;"></i>
                    </div>
                    <h2 style="margin: 0 0 0.5rem 0; color: #38bdf8; font-size: 1.8rem;">Teacher</h2>
                    <p style="font-size: 0.9rem; color: var(--text-secondary); margin: 0;">Create & Approve Events</p>
                </div>

                <form class="auth-form" data-role="teacher">
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Email</label>
                        <input type="email" class="chat-input" value="teacher@gmail.com" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Password</label>
                        <input type="password" class="chat-input" value="teacher@123" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <button type="submit" class="send-btn auth-btn"
                        style="width: 100%; background: #38bdf8; color: white; border: none; padding: 1rem; border-radius: 10px; font-weight: 600; font-size: 1rem; cursor: pointer; margin-top: 1rem;">
                        <i class="ph ph-sign-in"></i> Sign In as Teacher
                    </button>
                </form>
            </div>

            <!-- STUDENT Card -->
            <div class="role-card"
                style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(5, 150, 105, 0.08)); border: 2px solid rgba(16, 185, 129, 0.4); border-radius: 20px; padding: 2.5rem;">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div
                        style="width: 80px; height: 80px; margin: 0 auto 1rem; background: rgba(16, 185, 129, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="ph-fill ph-student" style="font-size: 3rem; color: #10b981;"></i>
                    </div>
                    <h2 style="margin: 0 0 0.5rem 0; color: #10b981; font-size: 1.8rem;">Student</h2>
                    <p style="font-size: 0.9rem; color: var(--text-secondary); margin: 0;">Request Events</p>
                </div>

                <form class="auth-form" data-role="student">
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Email</label>
                        <input type="email" class="chat-input" value="student@gmail.com" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <div class="form-group">
                        <label
                            style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Password</label>
                        <input type="password" class="chat-input" value="student@123" required
                            style="width: 100%; box-sizing: border-box; padding: 0.8rem; border-radius: 10px;">
                    </div>
                    <button type="submit" class="send-btn auth-btn"
                        style="width: 100%; background: #10b981; color: white; border: none; padding: 1rem; border-radius: 10px; font-weight: 600; font-size: 1rem; cursor: pointer; margin-top: 1rem;">
                        <i class="ph ph-sign-in"></i> Sign In as Student
                    </button>
                </form>
            </div>

        </div>

        <!-- Responsive Design for Mobile -->
        <style>
            @media (max-width: 1024px) {
                .auth-wrapper>div:nth-child(3) {
                    grid-template-columns: 1fr !important;
                    max-width: 400px;
                }
            }
        </style>
    </div>

    <script>
        const errorBox = document.getElementById('error-box');
        const authForms = document.querySelectorAll('.auth-form');

        // Handle all login forms
        authForms.forEach(form => {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                const email = form.querySelector('input[type="email"]').value;
                const password = form.querySelector('input[type="password"]').value;
                const role = form.dataset.role;

                errorBox.style.display = 'none';
                const btn = form.querySelector('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="ph ph-spinner ph-spin"></i> Signing in...';
                btn.disabled = true;

                try {
                    const res = await fetch('/api/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });
                    const data = await res.json();

                    if (res.ok) {
                        window.location.href = '/';
                    } else {
                        errorBox.innerHTML = '<i class="ph ph-warning"></i> ' + (data.error || "Authentication failed");
                        errorBox.style.display = 'block';
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                    }
                } catch (e) {
                    errorBox.innerHTML = '<i class="ph ph-warning-circle"></i> System Error. Please try again.';
                    errorBox.style.display = 'block';
                    console.error(e);
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            });
        });
    </script>
</body>

</html>